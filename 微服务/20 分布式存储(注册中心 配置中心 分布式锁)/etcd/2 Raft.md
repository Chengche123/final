1 两阶段提交:
    一: 
        **只要主节点把日志复制给大多数结点后就可以在主节点完成提交, 并返回给客户端**
        **之后会异步通知从节点完成提交**

2 选主:
    一: 选主规则:
        一: 
            **领导者周期性地向所有跟随者发送心跳消息**（即不包含日志项的日志复制 RPC 消息），通知大家我是领导者，阻止跟随者发起新的选举。
        二:
            如果在指定时间内，**跟随者没有接收到来自领导者的消息**，那么它就认为当前没有领导者，推举自己为候选人，发起领导者选举。
        三:
            在一次选举中，**赢得大多数选票的候选人**，将晋升为领导者。
        四:
            **在一个任期内，领导者一直都会是领导者**，直到它自身出现问题（比如宕机），或者因为网络延迟，其他节点发起一轮新的选举。
        五:
            在一次选举中，**每一个服务器节点最多会对一个任期编号投出一张选票**，并且按照“先来先服务”的原则进行投票。
        六:
            日志完整性高的跟随者（也就是最后一条日志项对应的任期编号值更大，索引号更大），**拒绝投票给日志完整性低的候选人。**
    二: 
        随机超时时间:
            Raft 算法巧妙地使用随机选举超时时间的方法，**把超时时间都分散开来，在大多数情况下只有一个服务器节点先发起选举**，而不是同时发起选举，这样就能减少因选票瓜分导致选举失败的情况。
    
3 日志:
    一: 如何复制日志？
            1)
                首先，领导者进入第一阶段，**通过日志复制（AppendEntries）RPC 消息**，将日志项复制到集群其他节点上。
            2)
                接着，**如果领导者接收到大多数的“复制成功”响应后**，它将日志项应用到它的状态机，并返回成功给客户端。如果领导者没有接收到大多数的“复制成功”响应，那么就返回错误给客户端。
            3) 
                领导者将日志项应用到它的状态机，怎么没通知跟随者应用日志项呢？
                    这是 Raft 中的一个优化，领导者不直接发送消息通知其他节点应用指定日志项。因为领导者的日志复制 RPC 消息或心跳消息，包含了当前最大的，将会被提交（Commit）的日志项索引值。所以通过日志复制 RPC 消息或心跳消息，跟随者就可以知道领导者的日志提交位置信息。因此，**当其他节点接受领导者的心跳消息，或者新的日志复制 RPC 消息后，就会将这条日志项应用到它的状态机。**
    二: 日志复制过程举例:
            1)
                接收到客户端请求后，领导者基于客户端请求中的指令，创建一个新日志项，并附加到本地日志中。
            2)
                领导者通过日志复制 RPC，将新的日志项复制到其他的服务器。
            3)
                当领导者将日志项，成功复制到大多数的服务器上的时候，领导者会将这条日志项应用到它的状态机中。
            4)
                领导者将执行的结果返回给客户端。
            5)
                当跟随者接收到心跳信息，或者新的日志复制 RPC 消息后，如果跟随者发现领导者已经提交了某条日志项，而它还没应用，那么跟随者就将这条日志项应用到本地的状态机中。














